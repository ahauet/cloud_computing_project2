AWSTemplateFormatVersion: '2010-09-09'
Description: This lambda process the image in order to resize it
Resources:
  Bucket1:
    Type: AWS::S3::Bucket
  Bucket2:
    Type: AWS::S3::Bucket
  Bucket3:
    Type: AWS::S3::Bucket
  Bucket4:
    Type: AWS::S3::Bucket
  TreatImage:
    Properties:
      CodeUri: s3://lingi2145-resources/e6977f7fd97616866211254a2bd55866
      Description: This lambda process the image in order to resize it
      Events:
        BucketEvent1:
          Properties:
            Bucket:
              Ref: Bucket1
            Events:
            - s3:ObjectCreated:*
            Filter:
              S3Key:
                Rules:
                - Name: prefix
                  Value: untreated/
                - Name: suffix
                  Value: .JPG
          Type: S3
        BucketEvent2:
          Properties:
            Bucket:
              Ref: Bucket2
            Events:
            - s3:ObjectCreated:*
            Filter:
              S3Key:
                Rules:
                - Name: prefix
                  Value: untreated/
                - Name: suffix
                  Value: .png
          Type: S3
        BucketEvent3:
          Properties:
            Bucket:
              Ref: Bucket3
            Events:
            - s3:ObjectCreated:*
            Filter:
              S3Key:
                Rules:
                - Name: prefix
                  Value: untreated/
                - Name: suffix
                  Value: .jpeg
          Type: S3
        BucketEvent4:
          Properties:
            Bucket:
              Ref: Bucket4
            Events:
            - s3:ObjectCreated:*
            Filter:
              S3Key:
                Rules:
                - Name: prefix
                  Value: untreated/
                - Name: suffix
                  Value: .jpg
          Type: S3
      Handler: index.handler
      MemorySize: 192
      Role: arn:aws:iam::828843326560:role/Lambda-role
      Runtime: nodejs4.3
      Timeout: 15
    Type: AWS::Serverless::Function
Transform: AWS::Serverless-2016-10-31
